<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>Technician Calendar Demo</title>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  <style>
    html,body {margin:0; padding:0; height:100%}
    #calendar {max-width: 1100px; margin:40px auto; height:90%}
  </style>
</head>
<body>
  <div id="calendar"></div>
  <script>
    const REPORT_TECH_PAGE_URL = "https://lookerstudio.google.com/reporting/XXXX/page/p_YYYY"; // ใส่ลิงก์จริงของคุณ

    // Mock data สำหรับทดสอบ (ใส่ไว้ตรงนี้ก่อนต่อ DB จริง)
    const mockData = [
      {date:"2025-09-08", tech_id:"T001", tech_name:"B", location:"Bangkok"},
      {date:"2025-09-08", tech_id:"T002", tech_name:"C", location:"Rayong"},
      {date:"2025-09-09", tech_id:"T003", tech_name:"A", location:"Chonburi"}
    ];

    function toEvents(rows){
      return rows.map(r => ({
        title: `${r.tech_name} — ${r.location}`,
        start: r.date,
        allDay: true,
        extendedProps: { tech_id: r.tech_id }
      }));
    }

    document.addEventListener('DOMContentLoaded', () => {
      const cal = new FullCalendar.Calendar(document.getElementById('calendar'), {
        initialView: 'dayGridMonth',
        locale: 'th',
        firstDay: 1,
        events: toEvents(mockData),
        eventClick: info => {
          const techId = info.event.extendedProps.tech_id;
          const url = `${REPORT_TECH_PAGE_URL}?params=tech_id:${encodeURIComponent(techId)}`;
          window.open(url, "_top");
        }
      });
      cal.render();
    });
  </script>
</body>
</html>
